/*Определите среднее, минимальное и максимальное количество дней, 
которые проходят с момента создания клиента (колонка create_date в таблице ads_clients_data) 
до момента запуска первого объявления этим клиентом (таблица ads_data).

Hint: здесь вам понадобится выражение INNER JOIN
*/

select min(diff), max(diff), avg(diff) from (
select mdate, client_union_id, create_date as cd, ad_id, (mdate - cd) as diff
from default.ads_clients_data acd 
inner join (
select min(date) as mdate, client_union_id, ad_id
from default.ads_data ad 
group by client_union_id, ad_id
order by client_union_id 
-- группируем данные в таблице объявлений по айди клиента
-- айди объявления и дате. выбираем наименьшую дату - это будет
-- дата первого показа
) as t
on t.client_union_id=acd.client_union_id
-- получившуюся таблицу с минимальными датами объединяем с 
-- таблицей клиентов по айди клиента
)
-- в итоговой таблице рассчитываем необходимые данные